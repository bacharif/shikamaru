(function(i,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("starknet")):typeof define=="function"&&define.amd?define(["exports","starknet"],e):(i=typeof globalThis<"u"?globalThis:i||self,e(i.guardian={},i.starknet))})(this,function(i,e){"use strict";var b=Object.defineProperty;var f=(i,e,a)=>e in i?b(i,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[e]=a;var d=(i,e,a)=>(f(i,typeof e!="symbol"?e+"":e,a),a);class a extends e.Signer{constructor(s,n){super(s);d(this,"cosigner");this.cosigner=n}async cosignMessage(s,n=!1){const r=await this.cosigner(s,n);return[e.number.toBN(r.signature.r).toString(),e.number.toBN(r.signature.s).toString()]}async signMessage(s,n){const r=await super.signMessage(s,n),o={message:s,accountAddress:e.addAddressPadding(n),chain:"starknet"},t=await this.cosignMessage(o,!0);return[...r,...t]}async signTransaction(s,n,r){const o=await super.signTransaction(s,n,r),t=e.transaction.fromCallsToExecuteCalldata(s),g={contractAddress:e.addAddressPadding(n.walletAddress),version:e.number.toBN(n.version).toString(10),calldata:t.map(u=>e.number.toHex(e.number.toBN(u))),maxFee:e.number.toBN(n.maxFee).toString(10),chainId:e.number.toBN(n.chainId).toString(10),nonce:e.number.toBN(n.nonce).toString(10)},c=await this.cosignMessage({message:g,type:"starknet"});return[...o,...c]}async signDeployAccountTransaction({classHash:s,contractAddress:n,constructorCalldata:r,addressSalt:o,maxFee:t,version:g,chainId:c,nonce:u}){const m=await super.signDeployAccountTransaction({classHash:s,contractAddress:n,constructorCalldata:r,addressSalt:o,maxFee:t,version:g,chainId:c,nonce:u}),p={classHash:s,salt:o,calldata:r.map(S=>e.number.toHex(e.number.toBN(S))),maxFee:e.number.toBN(t).toString(10),chainId:e.number.toBN(c).toString(10),version:g},l=await this.cosignMessage({message:p,type:"starknetDeploy"});return[...m,...l]}async signDeclareTransaction({classHash:s,senderAddress:n,chainId:r,maxFee:o,version:t,nonce:g}){return console.warn("TODO: implement GuardianSigner signDeclareTransaction"),super.signDeclareTransaction({classHash:s,senderAddress:n,chainId:r,maxFee:o,version:t,nonce:g})}}i.GuardianSigner=a,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
